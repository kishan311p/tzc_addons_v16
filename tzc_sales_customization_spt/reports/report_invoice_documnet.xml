<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_kits_invoice_document">
        <t t-call="web.external_layout">
            <div class="page">
                <div class="row">
                    <div class="col-7">
                        <strong t-if="o.partner_id">Billing Address:</strong>
                        <div>
                            <span t-field="o.partner_id.name"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.street"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.street2"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.city"/>
                            <span t-if="o.partner_id.city and o.partner_id.zip">,</span>
                            <span t-field="o.partner_id.zip"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.state_id.name"/>
                            <span t-if="o.partner_id.state_id.name and o.partner_id.country_id.name">,</span>
                            <span t-field="o.partner_id.country_id.name"/>
                        </div>
                        <div>Tel:
                    
                            <span t-field="o.partner_id.phone" />
                        </div>
                        <div>Email:
                    
                            <span t-field="o.partner_id.email" />
                        </div>
                    </div>
                    <div class="col-5">
                        <strong t-if="o.partner_id">Shipping Address:</strong>
                        <div>
                            <span t-field="o.partner_id.name"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.street"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.street2"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.city"/>
                            <span t-if="o.partner_id.city and o.partner_id.zip">,</span>
                            <span t-field="o.partner_id.zip"/>
                        </div>
                        <div>
                            <span t-field="o.partner_id.state_id.name"/>
                            <span t-if="o.partner_id.state_id.name and o.partner_id.country_id.name">,</span>
                            <span t-field="o.partner_id.country_id.name"/>
                        </div>
                        <div>Tel:
                    
                            <span t-field="o.partner_id.phone" />
                        </div>
                        <div>Email:
                    
                            <span t-field="o.partner_id.email" />
                        </div>
                    </div>
                </div>
                <h4 style="color:#808080;line-height: 0.6;">
                    <br/>
                    <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'">Invoice</span>
                    <span t-if="o.move_type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                    <span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                    <span t-if="o.move_type == 'out_refund'">Credit Note</span>
                    <span t-if="o.move_type == 'in_refund'">Vendor Credit Note</span>
                    <span t-if="o.move_type == 'in_invoice'">Vendor Bill</span>
                    <span t-if="o.name != '/'" t-field="o.name"/>
                </h4>
                <div class="row mt32 mb32" id="informations">
                    <t t-if="o.state == 'posted'">
                        <div class="col-auto mw-100 mb-2" t-if="o.invoice_date" name="invoice_date">
                            <strong>Invoice Date:</strong>
                            <p class="m-0" t-field="o.invoice_date"/>
                        </div>
                    </t>
                    <div class="col-auto mw-100 mb-2" t-if="o.invoice_origin" name="origin">
                        <strong>Sales Order:</strong>
                        <p class="m-0" t-field="o.invoice_origin"/>
                    </div>
                    <t t-set="kits_picking_details" t-value="o.get_invoice_courier()"/>
                    <div class="col-auto mw-100 mb-2">
                        <strong>Payment Terms:</strong>
                        <p class="m-0 text-left" t-esc="kits_picking_details[2]"/>
                    </div>
                    <div class="col-auto mw-100 mb-2 text-center">
                        <strong>Courier:</strong>
                        <p class="m-0 text-center" t-esc="kits_picking_details[0]"/>
                    </div>
                    <div class="col-auto mw-100 mb-2">
                        <strong>Tracking:</strong>
                        <p class="m-0 text-center" t-esc="kits_picking_details[1]"/>
                    </div>
                    <div class="col-auto mw-100 mb-2">
                        <strong>Total Qty:</strong>
                        <p class="m-0 text-center" t-esc="int(sum(request.env['account.move.line'].sudo().search([('move_id','=',o.id),('product_id.type','!=','service')]).mapped('quantity')))"/>
                    </div>
                    <div class="col-auto mw-100 mb-2">
                        <strong>Total Cases:</strong>
                        <p class="m-0 text-center" t-esc="int(request.env['sale.order'].sudo().search([('name','=',o.invoice_origin)]).no_of_cases)"/>
                    </div>
                    <div class="col-auto mw-100 mb-2">
                        <strong>Currency:</strong>
                        <p class="m-0 text-center" t-esc="o.currency_id.name"/>
                    </div>
                </div>

                <table class="table table-sm o_main_table">
                    <thead>
                        <tr class="text-center">
                            <th style="width: 6%;"></th>
                            <th class="text-left">Product</th>
                            <th>Cat</th>
                            <th>Material</th>
                            <th>HS Code</th>
                            <th>Qty</th>
                            <th class="text-right">Price</th>
                            <th class="text-right">Subtotal</th>
                        </tr>
                    </thead>
                    <t t-set="sub_total" t-value="0.00"/>
                    <t t-set="discount" t-value="abs(o.global_discount)"/>
                    <tbody class="sale_tbody">
                        <t t-foreach="o.invoice_line_ids" t-as="line">
                            <t t-if="not line.product_id.is_admin and not line.product_id.is_shipping_product and not line.product_id.is_global_discount">
                                <t t-set="discount" t-value="discount + line.unit_discount_price"/>
                                <tr class="text-center">
                                    <t t-if="line.sale_type">
                                        <td>
                                            <style>
                                                .te_ribbon-wrapper #style_3.label_div {
                                                    display: inline-block;
                                                    width: auto;
                                                    font-size: 0.8125rem;
                                                    background-color: #353e47;
                                                    position: absolute;
                                                    top: 10px;
                                                    right: unset;
                                                    bottom: unset;
                                                    left: 0px;
                                                    z-index: 1;
                                                    overflow: hidden;
                                                    @media (max-width:767px){
                                                        font-size: 0.0125rem;
                                                    }
                                                }
                                                .te_ribbon-wrapper #style_3.label_div .te_label_name.te_label_name_wish {
                                                    padding: 2px 4px !important;
                                                }
                                                .te_ribbon-wrapper #style_3.label_div .te_label_name.te_label_name_wish:before {
                                                    //content: "\f02b";
                                                    font-family: FontAwesome;
                                                    margin-right: 5px;
                                                    font-size: 8px;
                                                }
                                            </style>
                                            <div class="te_ribbon-wrapper" style="color:white">
                                                <div class="style_3 label_div" id="style_3" t-attf-style="background-color:#{'#e50000' if line.sale_type == 'on_sale' else '#990000' if line.sale_type == 'clearance' else ''};font-weight: bold;top: auto !important;left: 20px !important;font-size: 9px;">
                                                    <div class="p-1 te_label_name te_label_name_wish">
                                                        <span t-esc="dict(line._fields['sale_type'].selection).get(line.sale_type)"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td name="td_name" class="text-left">
                                            <span t-if="line.product_id.display_name" t-esc="line.product_id.display_name"/>
                                            <span t-else="">N/A</span>
                                        </td>
                                    </t>
                                    <t t-else="">
                                        <td name="td_name" class="text-left" colspan="2">
                                            <span t-if="line.product_id.display_name" t-esc="line.product_id.display_name"/>
                                            <span t-else="">N/A</span>
                                        </td>
                                    </t>
                                    <td name="td_name">
                                        <span t-if="line.product_id.categ_id" t-esc="line.product_id.categ_id.name"/>
                                        <span t-else="">N/A</span>
                                    </td>
                                    <td name="td_name">
                                        <span t-if="line.product_id.material_id" t-esc="', '.join(line.product_id.material_id.mapped('name'))"/>
                                        <span t-else="">N/A</span>
                                    </td>
                                    <td name="td_name">
                                        <span t-if="line.product_id.hs_code" t-esc="line.product_id.hs_code"/>
                                        <span t-else="">N/A</span>
                                    </td>
                                    <td name="td_name">
                                        <span t-if="line.quantity" t-esc="int(line.quantity)"/>
                                        <span t-else="">N/A</span>
                                    </td>
                                    <td name="td_name" class="text-right">
                                        <span t-field="line.discount_unit_price" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                    </td>
                                    <td name="td_name" class="text-right">
                                      <t t-set="sub_total" t-value="sub_total + line.price_subtotal"/>
                                        <span t-field="line.price_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                    <div class="clearfix" name="so_total_summary">
                        <div id="total" class="row" name="total" style="page-break-inside: auto">
                            <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                                <t t-set="html_val" t-value="o.get_html_field_val(o.company_id.bank_details)"/>
                                <t t-if="html_val">
                                    <table class="table table-sm table-borderless">
                                        <!-- <p style="page-break-before:always;"/> -->
                                        <tr>
                                            <div>
                                                <td>
                                                    <!-- <div style="border-style: groove;border-width: 1px; max-width: 90%;" >
                                                        <p name="comment" >
                                                            <span style="margin-left:10px;">
                                                                <b>Bank Transfer Details:</b>
                                                            </span>
                                                            <br/>
                                                            <span t-field="o.company_id.bank_details"/>
                                                        </p>
                                                    </div> -->
                                                </td>
                                            </div>
                                            <td>
                                                <div class="col-4" style="float:right;padding:0px;">
                                                    <table class="table table-sm">
                                                        <tr class="border-black">
                                                            <td>
                                                                <strong>Subtotal</strong>
                                                            </td>
                                                            <td name="td_admin" class="text-right">
                                                                <span t-esc="round(sub_total,2)" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_shipping_product_total_amount_label">
                                                                <strong>Shipping</strong>
                                                            </td>
                                                            <td name="td_amount_untaxed" class="text-right">
                                                                <t t-if="o.order_id.shipping_cost != o.order_id.amount_is_shipping_total">
                                                                    <span style="white-space: nowrap;color:red;text-decoration:line-through;">
                                                                        <span style='color:black;' t-field="o.order_id.shipping_cost" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/> 
                                                                    </span>
                                                                    /
                                                                    <span>
                                                                        <span style="color:red;" t-field="o.order_id.amount_is_shipping_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                                    </span>
                                                                </t>
                                                                <t t-else="">
                                                                    <span t-field="o.amount_is_shipping_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                                </t>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_admin_product_total_amount_label">
                                                                <strong>Admin Fee</strong>
                                                            </td>
                                                            <td name="td_admin" class="text-right">
                                                                <span t-field="o.amount_is_admin" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                        <t t-if="o.global_discount">
                                                            <tr class="border-black">
                                                                <td name="td_amount_discount_label">
                                                                    <strong>Discount</strong>
                                                                </td>
                                                                <td name="td_amount_discount" class="text-right o_price_total">
                                                                    <span t-esc="o.global_discount" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                                                </td>
                                                            </tr>
                                                        </t>
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Tax</strong>
                                                            </td>
                                                            <td name="td_amount_by_group" class="text-right o_price_total">
                                                                <span t-esc="o.amount_tax" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                            
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Total</strong>
                                                            </td>
                                                            <td style="white-space: nowrap;" name="td_amount_by_group" class="text-right o_price_total">
                                                            (                                    <span t-esc="o.currency_id.name"/>
                                                                )
                                                                <span t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" t-esc="round((sub_total + o.amount_is_shipping_total + o.amount_is_admin  + o.amount_tax) - abs(o.global_discount),2)"/>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Total Quantity</strong>
                                                            </td>
                                                            <td style="white-space: nowrap;" name="td_amount_by_group" class="text-right o_price_total">
                                                                <span t-esc="int(sum(request.env['account.move.line'].sudo().search([('move_id','=',o.id),('product_id.type','!=','service')]).mapped('quantity')))"/>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                    </table>
                                </t>
                                <t t-else="">
                                    <table class="table table-sm table-borderless">
                                        <tr>
                                            <div>
                                                <td>
                                                    <!-- <div style="border-style: groove;border-width: 1px; max-width: 90%;" >
                                                        <p name="comment" >
                                                            <span style="margin-left:10px;">
                                                                <b>Bank Transfer Details:</b>
                                                            </span>
                                                            <br/>
                                                            <span t-field="o.company_id.bank_details"/>
                                                        </p>
                                                    </div> -->
                                                </td>
                                            </div>
                                            <td>
                                                <div class="col-4" style="float:right;padding:0px;">
                                                    <table class="table table-sm">
                                                        <tr class="border-black">
                                                            <td>
                                                                <strong>Subtotal</strong>
                                                            </td>
                                                            <td name="td_admin" class="text-right">
                                                                <span t-esc="round(sub_total,2)" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_shipping_product_total_amount_label">
                                                                <strong>Shipping</strong>
                                                            </td>
                                                            <td name="td_amount_untaxed" class="text-right">
                                                                <t t-if="o.order_id.shipping_cost != o.order_id.amount_is_shipping_total">
                                                                    <span style="white-space: nowrap;color:red;text-decoration:line-through;">
                                                                        <span style='color:black;' t-field="o.order_id.shipping_cost" t-options='{"widget": "monetary", "display_currency": o.pricelist_id.currency_id}'/> 
                                                                    </span>
                                                                    /
                                                                    <span>
                                                                        <span style="color:red;" t-field="o.order_id.amount_is_shipping_total" t-options='{"widget": "monetary", "display_currency": o.pricelist_id.currency_id}'/>
                                                                    </span>
                                                                </t>
                                                                <t t-else="">
                                                                    <span t-field="o.amount_is_shipping_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                                </t>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_admin_product_total_amount_label">
                                                                <strong>Admin Fee</strong>
                                                            </td>
                                                            <td name="td_admin" class="text-right">
                                                                <span t-field="o.amount_is_admin" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                        <t t-if="o.global_discount">
                                                            <tr class="border-black">
                                                               <td name="td_amount_discount_label">
                                                                   <strong>Discount</strong>
                                                               </td>
                                                               <td name="td_amount_discount" class="text-right o_price_total">
                                                                   <span t-esc="o.global_discount" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                                               </td>
                                                            </tr>
                                                        </t>
                            
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Tax</strong>
                                                            </td>
                                                            <td name="td_amount_by_group" class="text-right o_price_total">
                                                                <span t-esc="o.amount_tax" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                            
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Total</strong>
                                                            </td>
                                                            <td style="white-space: nowrap;" name="td_amount_by_group" class="text-right o_price_total">
                                                            (                                    <span t-esc="o.currency_id.name"/>
                                                                )
                                                                <span t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" t-esc="round((sub_total + o.amount_is_shipping_total + o.amount_is_admin  + o.amount_tax) - abs(o.global_discount),2)"/>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-black">
                                                            <td name="td_amount_by_group_label">
                                                                <strong>Total Quantity</strong>
                                                            </td>
                                                            <td style="white-space: nowrap;" name="td_amount_by_group" class="text-right o_price_total">
                                                                <span t-esc="int(sum(request.env['account.move.line'].sudo().search([('move_id','=',o.id),('product_id.type','!=','service')]).mapped('quantity')))"/>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                    </table>
                                </t>
                            </div>
                        </div>
                    </div>
                </table>
                <p style="page-break-before:always;"/>
                <div class="col-12 d-flex p-0">
                    <div class="col-9 row mt-5" style="font-family: 'Lato', sans-serif;">
                        <table style="width: 70%;font-family: 'Lato', sans-serif;">
                            <t t-if="o.invoice_origin">
                                <tr>
                                    <th>Invoice Number:</th>
                                    <td><span t-field="o.invoice_origin"/></td>
                                </tr>
                            </t>
                            <t t-if="o.invoice_date">
                                <tr>
                                    <th>Invoice Date:</th>
                                    <td><span t-field="o.invoice_date"/></td>
                                </tr>
                            </t>
                            <t t-if="o.currency_id">
                                <tr>
                                    <th>Currency:</th>
                                    <td><span t-field="o.currency_id"/></td>
                                </tr>
                            </t>
                            <t t-if="o.amount_total">
                                <tr>
                                    <th>Amount:</th>
                                    <td>(<span t-field="o.currency_id"/>) <span t-field="o.amount_total"/></td>
                                </tr>
                            </t>
                            <t t-if="o.invoice_payment_term_id">
                                <tr>
                                    <th>Payment Terms:</th>
                                    <td><span t-esc="o.invoice_payment_term_id.name"/></td>
                                </tr>
                            </t>
                        </table>
                    </div>
                </div>
                <div class='mt-5' style="background-color:#f2f2f2;page-break-after:always;">
                    <br/>
                    <div class="row ml-1">
                        <h5 style="font-family: 'Lato', sans-serif;color:#404040;font-weight: bold;">How to pay your bill</h5>
                    </div>
                    <br/>
                    <div class="row col-12">
                        <div class='col-4'>
                            <strong style="color:red;">Credit Cards</strong><br/>
                            <span style="font-family: 'Lato', sans-serif;">We accept all major credit cards in select currencies.<br/>Payments can be made via our secure payment link. Contact your account manager.</span>
                        </div>
                        <div class='col-4'>
                            <strong style="color:red;">Company Information</strong><br/>
                            <span style="font-family: 'Lato', sans-serif;">Tanzacan Tradelink Inc.<br/>Tax Number: 898737911 RM0001<br/>Since 1995</span>
                        </div>
                    </div>
                    <br/>
                    <br/>
                    <div class='ml-1'>
                        <strong style="color:red;">Paypal</strong><br/>
                        <span style="font-family: 'Lato', sans-serif;">Send payments via Paypal on our email: pay@tanzacan.com.</span>
                    </div>
                    <br/>
                    <br/>
                    <div class='ml-1'>
                        <strong style="color:red;">Bank Transfer</strong><br/>
                        <span style="font-family: 'Lato', sans-serif;">
                            Beneficiary Name &amp; Address: Tanzacan Tradelink Inc., 366 Denison Street, Suite 4, Markham, Ontario, Canada L3R 1B9
                            <br/>
                            Beneficiary Bank Name &amp; Address: TD Canada Trust, 7085 Woodbine Avenue, Markham, Ontario, Canada L3R 1A3
                            <br/>
                            Account Number: USD Account 7324227
                            <br/>
                            Branch Number: 12772
                            <br/>
                            Bank Number: 004
                            <br/>
                            SWIFT Code: TDOMCATTTOR
                            <br/>
                            Canadian Clearing Code (CC Code): 000412772
                        </span>
                    </div>
                    <br/>
                </div>

            </div>
        </t>
        
    </template>
    <template id="kits_invoice_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="tzc_sales_customization_spt.report_kits_invoice_document" t-lang="o.partner_id.lang"/>
            </t>
        </t>
    </template>
</odoo>